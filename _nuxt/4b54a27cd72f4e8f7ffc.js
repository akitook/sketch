(window.webpackJsonp=window.webpackJsonp||[]).push([[12,24],{152:function(e,t,n){var content=n(155);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(37).default)("2e7fdbb2",content,!0,{sourceMap:!1})},153:function(e){e.exports=JSON.parse('{"arjs01":{"id":"arjs01","title":"AR#01","desc":"ar.js","category":"threejs","date":"2019-07-17","bg":"white","references":[{"title":"ar.js","url":"https://github.com/jeromeetienne/AR.js/blob/master/README.md"}]},"faceTracker":{"id":"faceTracker","title":"smile tracker","desc":"Use WebCam and clmtrackr","category":"threejs","date":"2019-07-04","bg":"white","references":[{"title":"clmtrackr","url":"https://github.com/auduno/clmtrackr"}]},"bigsight":{"id":"bigsight","title":"bigsight","desc":"Reffered to chapter 8 in 「Learning Three.js」","category":"threejs","date":"2019-07-04","bg":"black","references":[{"title":"three.js examples","url":"https://threejs.org/examples/#webgl_loader_obj_mtl"}]},"tube":{"id":"tube","title":"TUBE","desc":"Reffered to chapter 7 in 「Learning Three.js」","category":"threejs","date":"2019-07-02","bg":"black"},"sns":{"id":"sns","title":"SNS","desc":"Reffered to chapter 7 in 「Learning Three.js」","category":"threejs","date":"2019-07-02","bg":"black"},"learningThreejs03":{"id":"learningThreejs03","title":"Learning 03","desc":"Reffered to chapter 6 in 「Learning Three.js」","category":"threejs","date":"2019-06-30","bg":"white","references":[{"title":"font","url":"http://ymnk-design.com/wordpress/%E3%83%97%E3%81%B7%E3%83%97/"}]},"learningThreejs02":{"id":"learningThreejs02","title":"Learning 02","desc":"Reffered to chapter 4 in 「Learning Three.js」","category":"threejs","date":"2019-06-28","bg":"black"},"learningThreejs01":{"id":"learningThreejs01","title":"Learning 01","desc":"Reffered to 「Learning Three.js」book.","category":"threejs","date":"2019-06-25","bg":"white"},"earth":{"id":"earth","title":"earth","desc":"This is the third of sketch with three.js","category":"threejs","date":"2019-06-25","bg":"black"},"moon":{"id":"moon","title":"moon","desc":"This is the second of sketch with three.js","category":"threejs","date":"2019-06-25","bg":"black"},"first":{"id":"first","title":"first","desc":"This is the first of sketch with three.js","category":"threejs","date":"2019-06-15","bg":"white"}}')},154:function(e,t,n){"use strict";var r=n(152);n.n(r).a},155:function(e,t,n){(e.exports=n(36)(!1)).push([e.i,".page-enter-active[data-v-15b98f7e],.page-leave-active[data-v-15b98f7e]{transition:opacity .5s}.page-enter[data-v-15b98f7e],.page-leave-active[data-v-15b98f7e]{opacity:0}.InfoPanel[data-v-15b98f7e]{position:absolute;bottom:24px;left:24px;max-width:640px;z-index:1}.InfoPanel.bg-white[data-v-15b98f7e]{color:rgba(0,0,0,.87)}.InfoPanel.bg-white .info-category[data-v-15b98f7e]{color:rgba(0,0,0,.54)}.InfoPanel.bg-white .back-button a[data-v-15b98f7e]{color:rgba(0,0,0,.87);border-color:rgba(0,0,0,.87)}.InfoPanel.bg-black[data-v-15b98f7e]{color:#fff}.InfoPanel.bg-black .info-category[data-v-15b98f7e]{color:hsla(0,0%,100%,.7)}.InfoPanel.bg-black .back-button a[data-v-15b98f7e]{color:#fff;border-color:#fff}.info-title[data-v-15b98f7e]{font-size:48px;letter-spacing:-2px}.info-category[data-v-15b98f7e]{font-size:12px;margin-bottom:16px}.info-date[data-v-15b98f7e],.info-desc[data-v-15b98f7e]{font-size:12px;margin-bottom:6px}.info-date[data-v-15b98f7e]{display:block}.back-button[data-v-15b98f7e]{z-index:1}.back-button a[data-v-15b98f7e]{font-size:14px;display:inline-block;padding:4px 16px;text-decoration:none;border:1px solid #fff;border-radius:16px}@media screen and (min-width:768px){.InfoPanel[data-v-15b98f7e]{bottom:24px;left:48px}.info-title[data-v-15b98f7e]{font-size:64px}.info-category[data-v-15b98f7e],.info-date[data-v-15b98f7e],.info-desc[data-v-15b98f7e]{font-size:14px}.info-date[data-v-15b98f7e]{display:block;margin-bottom:6px}}",""])},156:function(e,t,n){"use strict";var r={props:{article:{type:Object,default:function(){return{bg:"",title:"",desc:"",date:"",category:""}}}},mounted:function(){}},o=(n(154),n(18)),component=Object(o.a)(r,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"InfoPanel",class:"bg-"+e.article.bg},[n("h1",{staticClass:"info-title"},[e._v(e._s(e.article.title))]),e._v(" "),n("p",{staticClass:"info-desc"},[e._v(e._s(e.article.desc))]),e._v(" "),n("time",{staticClass:"info-date",attrs:{datetime:e.article.date}},[e._v("posted: "+e._s(e.article.date))]),e._v(" "),n("div",{staticClass:"info-category"},[e._v("#"+e._s(e.article.category))]),e._v(" "),n("div",{staticClass:"back-button"},[n("nuxt-link",{attrs:{to:"/"}},[e._v("← HOME")])],1)])},[],!1,null,"15b98f7e",null);t.a=component.exports},186:function(e,t,n){var content=n(231);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(37).default)("0a0763c3",content,!0,{sourceMap:!1})},230:function(e,t,n){"use strict";var r=n(186);n.n(r).a},231:function(e,t,n){(e.exports=n(36)(!1)).push([e.i,".page-enter-active[data-v-71c36694],.page-leave-active[data-v-71c36694]{transition:opacity .5s}.page-enter[data-v-71c36694],.page-leave-active[data-v-71c36694]{opacity:0}.visual[data-v-71c36694]{width:100vw;height:100vh;display:flex;justify-content:center;align-items:center}.video-container[data-v-71c36694]{position:relative;overflow:hidden;width:300px;height:300px;border-radius:150px}.canvas[data-v-71c36694],.video[data-v-71c36694]{display:block;position:absolute;top:0;left:0}.threejs-canvas[data-v-71c36694]{position:absolute;top:0;left:0;z-index:-1}.start-button[data-v-71c36694]{display:block;width:300px;padding:24px 48px;top:50%;left:calc(50% - 150px)}.dat[data-v-71c36694]{left:0}.dat[data-v-71c36694],.gui-input[data-v-71c36694]{position:absolute;top:0}.gui-input[data-v-71c36694]{right:0;z-index:1}@media screen and (min-width:768px){.video-container[data-v-71c36694]{width:480px;height:480px;border-radius:240px}}",""])},280:function(e,t,n){"use strict";n.r(t);n(218);var r,o=n(221),c=n(156),d=n(153),l=n(159),v=n(160),h=n(24),f=function(){function e(){Object(l.a)(this,e),Object(h.a)(this,"getEmotions",function(){return this.emotions}),this.previousParameters=[],this.classifier={},this.emotions=[],this.coefficient_length=""}return Object(v.a)(e,[{key:"init",value:function(e){for(var t in e)this.emotions.push(t),this.classifier[t]={},this.classifier[t].bias=e[t].bias,this.classifier[t].coefficients=e[t].coefficients;this.coefficient_length=this.classifier[this.emotions[0]].coefficients.length}},{key:"getBlank",value:function(){for(var e=[],t=0;t<this.emotions.length;t++)e[t]={emotion:this.emotions[t],value:0};return e}},{key:"predict",value:function(e){for(var t=[],n=0;n<this.emotions.length;n++){for(var r=this.emotions[n],o=this.classifier[r].bias,i=0;i<this.coefficient_length;i++)o+=this.classifier[r].coefficients[i]*e[i+6];t[n]={emotion:r,value:0},t[n].value=1/(1+Math.exp(-o))}return t}},{key:"meanPredict",value:function(e){if(this.previousParameters.splice(0,10===this.previousParameters.length?1:0),this.previousParameters.push(e.slice(0)),this.previousParameters.length>9){for(var t=[],i=0;i<e.length;i++)t[i]=0;for(var n=0;n<this.previousParameters.length;n++)for(var r=0;r<e.length;r++)t[r]+=this.previousParameters[n][r];for(var o=0;o<e.length;o++)t[o]/=10;return this.predict(t)}return!1}}]),e}(),m={angry:{bias:-2.3768163629,coefficients:[-.02627030047441385,.037963304603547195,.25318394482150264,-.368016943547098,-.05963862192543184,6314505690001057e-32,.09452005927265185,.213472443663889,.4288531365269062,-15592214434343613e-30,.13850079872874066,-5148591066666531e-31,.33298910350203975,8035736391933024e-31,.002532509636369606,-.4461509096406595,-15784656134660036e-31,.047596008125675944]},disgusted:{bias:-2.27900176842,coefficients:[.042360511043701296,.1282033922181087,.12391812407152457,-.27567823277270387,.1421150306247343,-3108185676662429e-31,.12612972927139088,.23426310789552218,.058894842405560956,-4061831165785685e-30,.22340906131116328,-581584759084207e-29,.2573521859550001,13658078149815552e-31,-.1250685014060595,-.9463447584787309,-4555025133881674e-30,.07141679477545719]},fear:{bias:-3.40339917096,coefficients:[-.1484066846778026,-.09007986058314447,-.16138464891003612,.0787501432508056,.07052107586434932,36426173865029096e-30,.5410603323963026,.04958663989052879,-.10793093750863458,-51279691693889055e-31,-.09224323615568367,-15165430767377168e-30,.19842076279793416,3828296047967023e-30,-.6736718403051464,-.2166709100861198,11995348541944584e-30,-.20024153378658624]},sad:{bias:-2.75274632938,coefficients:[.09261101000170545,-.1288353042774852,-.0689759946049493,-.19623077060801897,.0553121978432948,-35874521027522394e-32,.46315306348086854,-.3210362284365436,-.4653662689188549,1725612051187888e-29,-.4084153555239968,21258665882389598e-30,.4540520401162594,5919428939222667e-30,.0944105006551519,-.4861387223131064,-3030330454831321e-30,.7370825465376556]},surprised:{bias:-2.86262062696,coefficients:[-.12854109490879712,-.049194392540246726,-.22856553950573175,.2992140056765602,-.25975558754705375,1.4688408313649554e-9,-.13685597104348368,-.23581884244542603,.02644718005809746,1.6822695398601112e-10,.09571230486442192,-4.467023007413259e-10,.4050570608526974,27821987602166784e-27,-.5436785654358883,-.09632094578291915,1.423980119551645e-10,-.7238167998685946]},happy:{bias:-1.4786712822,coefficients:[.014837209675880276,.31092627456808286,-.1214238695400552,.45265837869400843,.3670014025990089,17113646510738279e-31,-.4786251427206033,-.153773695055218,-.16948121903942992,6030027262917625e-30,-.02118499272787567,-6931860688129296e-30,-.8161160355158885,-3788356023844266e-30,.1486320646217055,.9497341035176953,36260400713070416e-31,-.3136117994300741]}},w=(n(55),n(7)),y=n(70),x=function(){function e(){Object(l.a)(this,e),this.uniforms={time:{type:"f",value:0},force:{type:"f",value:0}},this.obj=null}return Object(v.a)(e,[{key:"createObj",value:function(){var e=new y.SphereBufferGeometry(150,128,128,0,6.3,0,1.6),t=new y.RawShaderMaterial({uniforms:this.uniforms,vertexShader:"#define GLSLIFY 1\nattribute vec3 position;\nattribute vec2 uv;\n\nuniform mat4 projectionMatrix;\nuniform mat4 modelViewMatrix;\nuniform float time;\nuniform float force;\n\nvarying vec3 vColor;\n\nvec3 convertHsvToRgb(vec3 c) {\n  vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n  vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n  return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\nvoid main(void) {\n  // calculate gradation\n  vec3 hsv = vec3(0.1 + sin(radians(uv.y * 180.0 * 4.0)) * 0.12 - time * 0.1, 0.12 + force * 0.3, 0.96 - force * 0.03);\n  vec3 rgb = convertHsvToRgb(hsv);\n\n  // coordinate transformation\n  vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);\n\n  vColor = rgb;\n\n  gl_Position = projectionMatrix * mvPosition;\n}\n",fragmentShader:"precision highp float;\n#define GLSLIFY 1\n\nvarying vec3 vColor;\n\nvoid main() {\n  gl_FragColor = vec4(vColor, 1.0);\n}\n",side:y.BackSide});this.obj=new y.Mesh(e,t);var n=-90*Math.PI/180;this.obj.rotation.set(n,0,0)}},{key:"render",value:function(time,e){this.uniforms.force.value=e,this.uniforms.time.value-=1e3*time*(8*e)}}]),e}(),j=(n(223),function(){function e(){Object(l.a)(this,e),this.uniforms={time:{type:"f",value:0},force:{type:"f",value:0}},this.obj=null}return Object(v.a)(e,[{key:"createObj",value:function(){for(var e=new y.BufferGeometry,t=[],n=[],i=0;i<1e3;i+=3){var r=Math.random()*Math.random()*60,o=360*Math.random()*Math.PI/180;t[i+0]=Math.cos(o)*r,t[i+1]=Math.sin(o)*r,t[i+2]=0,n[i/3]=8*Math.random()}var c=new y.BufferAttribute(new Float32Array(t),3),d=new y.BufferAttribute(new Float32Array(n),1);e.addAttribute("position",c),e.addAttribute("delay",d);var l=new y.RawShaderMaterial({uniforms:this.uniforms,vertexShader:"#define GLSLIFY 1\nattribute vec3 position;\nattribute float delay;\n\nuniform mat4 projectionMatrix;\nuniform mat4 modelViewMatrix;\nuniform float time;\nuniform float force;\n\nvarying vec3 vColor;\nvarying float vOpacity;\n\nvec3 convertHsvToRgb(vec3 c) {\n  vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n  vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n  return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\nconst float duration = 8.0;\n\nvoid main() {\n  // Loop animation\n  float interval = mod(time + delay, duration) / duration;\n  vec3 move = vec3(0.0, 0.0, (interval * 2.0 - 1.0) * 100.0);\n\n  // calculate gradation with position.y\n  vec3 hsv = vec3(0.3 + time * 0.1, 0.65 - force * 0.01, 0.85 + force * 0.01);\n  vec3 rgb = convertHsvToRgb(hsv);\n\n  // coordinate transformation\n  vec4 mvPosition = modelViewMatrix * vec4(position + move, 1.0);\n  float distanceFromCamera = 1000.0 / length(mvPosition.xyz);\n\n  vColor = rgb;\n  vOpacity = smoothstep(-100.0, 100.0, move.z);\n\n  gl_Position = projectionMatrix * mvPosition;\n  gl_PointSize = distanceFromCamera;\n}\n",fragmentShader:"precision highp float;\n#define GLSLIFY 1\n\nvarying vec3 vColor;\nvarying float vOpacity;\n\nvoid main() {\n  // convert PointCoord to range from -1.0 to 1.0\n  vec2 p = gl_PointCoord * 2.0 - 1.0;\n\n  // draw double circle\n  float radius = length(p);\n  float opacity = (1.0 - smoothstep(0.9, 1.0, radius)) * vOpacity;\n\n  gl_FragColor = vec4(vColor, opacity);\n}\n",transparent:!0,depthWrite:!1});this.obj=new y.Points(e,l)}},{key:"render",value:function(time,e){this.uniforms.force.value=e,this.uniforms.time.value+=1e3*time*(5*e)}}]),e}()),k=new y.Clock({autoStart:!1}),C=new y.PerspectiveCamera(45,window.innerWidth/window.innerHeight,.1,1e3),P=function(){function e(){var t=this;Object(l.a)(this,e),Object(h.a)(this,"renderLoop",Object(w.a)(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.step+=.005,e.next=3,t.render();case 3:requestAnimationFrame(function(){t.renderLoop()});case 4:case"end":return e.stop()}},e)}))),(r=new y.WebGLRenderer({canvas:document.querySelector("#threejs-canvas"),alpha:!0})).setSize(window.innerWidth,window.innerHeight),r.setPixelRatio(window.devicePixelRatio),r.setClearColor(15658734,1),this.scene=new y.Scene,C.position.set(0,0,100),C.lookAt(new y.Vector3(0,0,0)),this.step=0,this.sphere=null,k.start(),this.time=k.getDelta(),this.bg=new x,this.bg.createObj(),this.scene.add(this.bg.obj),this.points=new j,this.points.createObj(),this.scene.add(this.points.obj)}return Object(v.a)(e,[{key:"render",value:function(e){this.bg.render(this.time,e),this.points.render(this.time,e),r.render(this.scene,C)}}]),e}(),M={components:{InfoPanel:c.a},data:function(){return{video:null,vw:0,vh:0,vx:0,vy:0,overlay:null,overlayCC:null,ctrack:null,trackingStarted:!1,classifier:null,animationFrame:!1,article:d.faceTracker,threeCanvas:null}},mounted:function(){this.video=document.getElementById("video"),this.overlay=document.getElementById("overlay"),this.overlayCC=this.overlay.getContext("2d"),navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,window.URL=window.URL||window.webkitURL||window.msURL||window.mozURL,navigator.mediaDevices?navigator.mediaDevices.getUserMedia({video:{faingMode:"user"},audio:!1}).then(this.gumSuccess).catch(this.gumFail):navigator.getUserMedia?navigator.getUserMedia({video:!0},this.gumSuccess,null):alert("Your browser does not seem to support getUserMedia, using a fallback video instead."),this.ctrack=new o.a.tracker({faceDetection:{useWebWorkers:!1}}),this.ctrack.init(),this.trackingStarted=!1,this.threeCanvas=new P,this.startVideo()},destroyed:function(){window.console.log("destroyed"),this.video.srcObject.getTracks().forEach(function(track){track.stop()}),cancelAnimationFrame(this.animationFrame),this.video.srcObject=null,this.trackingStarted=!1,this.video.src=null,this.ctrack=null,this.threeCanvas.scene.remove(this.threeCanvas.scene.children),this.threeCanvas.scene.children.length=0,this.threeCanvas=!1},methods:{adjustVideoProportions:function(){this.video.videoWidth>this.video.videoHeight?(this.vh=480,this.vw=this.video.videoWidth*(480/this.video.videoHeight),this.vx=-(this.vw-480)/2,this.vy=0):(this.vw=480,this.vh=this.video.videoHeight*(480/this.video.videoHeight),this.vy=-(this.vh-480)/2,this.vx=0)},gumSuccess:function(e){var t=this;"srcObject"in this.video?this.video.srcObject=e:this.video.src=window.URL&&window.URL.createObjectURL(e),this.video.onloadedmetadata=function(){t.adjustVideoProportions()},this.video.onresize=function(){t.adjustVideoProportions(),t.trackingStarted&&(t.ctrack.stop(),t.ctrack.reset(),t.ctrack.start(t.video))}},startVideo:function(){this.ctrack.start(this.video),this.trackingStarted=!0,this.classifier=new f,this.classifier.init(m),this.drawLoop()},drawLoop:function(){this.animationFrame=requestAnimationFrame(this.drawLoop),this.overlayCC.clearRect(0,0,this.vw,this.vh),this.ctrack.getCurrentPosition()&&this.ctrack.draw(this.overlay);var e=this.ctrack.getCurrentParameters(),t=this.classifier.meanPredict(e);this.showEmotionData(t);var n=t?Number(t[5].value):.5;this.threeCanvas.render(n)},showEmotionData:function(e){for(var t="",i=0;i<e.length;i++)t+=e[i].emotion+": "+e[i].value.toFixed(1)+"<br>";document.getElementById("dat").innerHTML=t}}},L=(n(230),n(18)),component=Object(L.a)(M,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"faceTracker"},[n("InfoPanel",{attrs:{article:e.article}}),e._v(" "),n("div",{staticClass:"visual"},[n("div",{staticClass:"video-container"},[n("video",{staticClass:"video",style:"top: "+e.vy+"px; left: "+e.vx+"px;",attrs:{id:"video",preload:"auto",loop:"",playsinline:"",autoplay:"",width:e.vw,height:e.vh}}),e._v(" "),n("canvas",{staticClass:"canvas",style:"top: "+e.vy+"px; left: "+e.vx+"px;",attrs:{id:"overlay",width:e.vw,height:e.vh}})])]),e._v(" "),n("div",{staticClass:"dat",attrs:{id:"dat"}}),e._v(" "),n("canvas",{staticClass:"threejs-canvas",attrs:{id:"threejs-canvas"}})],1)},[],!1,null,"71c36694",null);t.default=component.exports}}]);